<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>AppQoe Series: Packet Duplication | NetWithAlex</title>
<meta name="keywords" content="">
<meta name="description" content="Learn how Packet Duplication can help you reliably transmit critical traffic over unreliable transports to making sure your application.">
<meta name="author" content="Alex">
<link rel="canonical" href="http://localhost:1313/appqoe-pkt-dup-en/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css" integrity="sha256-1vzSCk&#43;4bvpN&#43;sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/appqoe-pkt-dup-en/">
<link rel="alternate" hreflang="es" href="http://localhost:1313/appqoe-pkt-dup-es/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>















    
        <link rel="preconnect" href="https://plausible.io">
    
        <!-- Dev mode : We do not load plausible script to avoid bloating your stats -->

<!-- If you are using Content-Security-Policy, do not forget to add this code to your CSP : 
  script-src 'unsafe-inline' https://plausible.io
  connect-src 'unsafe-inline' https://plausible.io
  or just add the partial 'plausible_csp.html' to those 2 csp directives in your 'index.headers' file
-->



    
    <script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
    <script>
         
         
         
    </script>

    

<link rel="stylesheet" href="/assets/css/custom.css">
<meta property="og:url" content="http://localhost:1313/appqoe-pkt-dup-en/">
  <meta property="og:site_name" content="NetWithAlex">
  <meta property="og:title" content="AppQoe Series: Packet Duplication">
  <meta property="og:description" content="Learn how Packet Duplication can help you reliably transmit critical traffic over unreliable transports to making sure your application.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-06-03T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AppQoe Series: Packet Duplication">
<meta name="twitter:description" content="Learn how Packet Duplication can help you reliably transmit critical traffic over unreliable transports to making sure your application.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "AppQoe Series: Packet Duplication",
      "item": "http://localhost:1313/appqoe-pkt-dup-en/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "AppQoe Series: Packet Duplication",
  "name": "AppQoe Series: Packet Duplication",
  "description": "Learn how Packet Duplication can help you reliably transmit critical traffic over unreliable transports to making sure your application.",
  "keywords": [
    
  ],
  "articleBody": "Introduction On my previous post I talked about FEC, a technique to fight packet loss by sending a parity packet to reconstruct missing data. In this post, we’ll explore another powerful SD-WAN feature designed to tackle lossy transports: Packet Duplication. While both features aim to improve reliability, they achieve it in very different ways.\nLet’s dive in:\nWhat is Packet Duplication As the name suggests, Packet Duplication involves sending identical packets over multiple transport paths to increase the likelihood of successful delivery. If one path experiences transient loss or is inherently unreliable, the duplicate packet sent over a second, more stable transport can make up for it, keeping the user experience unaffected.\nTo put it visually:\nThe sender uses both the bronze and gold transports to send the duplicate information. The bronze path suffers from packet loss, while the gold path delivers all packets successfully. The receiver discards duplicates and forwards only the earliest received copy to the destination, effectively eliminating loss from the user’s perspective — regardless of which path the packet took.\nBefore duplicating a packet, the wan edge will compare its size against the Path Maximum Transmission Unit (PMUT), if the packet length is smaller than the PMUT, packet gets duplicated.\nNote Starting on version 17.15.1a, packets can be duplicated even if length is greater than PMUT, using VRF and Underlay Fragmentation.\nStarting from version 16.12.1b this feature is applicable for\nIPv4 traffic over IPv4 tunnels. Starting 17.15.1a to support is expanded to:\nIPv4 traffic over IPv6 tunnel IPv6 traffic over IPv4 tunnels IPv6 traffic over IPv6 tunnels Considerations Here are a few key points to keep in mind when enabling Packet Duplication:\nFor packet duplication to work, there should be at least two available transports, this is not a suitable solution for single transport sites. The amount of traffic will be doubled keep it mind based on transport capacities. The receiver will need to buffer and discard packets, adding processing overhead Should be enabled for critical traffic only, based on previous considerations. Configuration Using Policy Groups, we can configure Packet Duplication through a data policy that matches intended traffic and applies an action of Loss Correction and select Packet Duplication\nThis configuration should be applied on both directions, so the complete policy looks like this:\ndata-policy data_service_Packet-Duplication vpn-list vpn_Corporate_Users sequence 1 match source-ip 172.16.100.0/24 destination-ip 172.16.10.0/24 ! action accept loss-protect pkt-dup loss-protection packet-duplication ! ! sequence 11 match source-ip 172.16.10.0/24 destination-ip 172.16.100.0/24 ! action accept loss-protect pkt-dup loss-protection packet-duplication ! ! default-action accept ! ! ! apply-policy site-list site_10_100 data-policy data_service_Packet-Duplication from-service ! ! Note Packet duplication is not supported along with the following data policy actions:\nlocal tloc remote_tloc You can read the configuration guide to get more information on restrictions and more.\nVerification To ensure Packet Duplication is working there are a couple of things we can validate.\nFrom the device we can run:\nLisbon_10-1#show sdwan tunnel statistics pkt-dup Generating output, this might take time, please wait ... tunnel stats gre 21.11.0.2 21.101.0.2 0 0 pktdup-rx 4844 pktdup-rx-other 1 pktdup-rx-this 4844 pktdup-tx 8710 pktdup-tx-other 4693 pktdup-capable true tunnel stats gre 31.11.0.2 31.101.0.2 0 0 pktdup-rx 1 pktdup-rx-other 4844 pktdup-rx-this 1 pktdup-tx 4693 pktdup-tx-other 8710 pktdup-capable true pktdup-rx - original packets received on primary tunnel pktdup-rx-other - duplicate packets received on second tunnel pktdup-tx - duplicate packets sent on primary tunnel pktdup-tx-other - duplicate packets sent from secondary tunnel pktdup-capable - Capability exchange with other devices The same information is available through the Manager’s UI in the Real Time information section.\nAdditionally, a counter can be added the the policy to confirm the sequence is getting matched.\nTesting Packet Duplication In my setup, I have two active tunnels between the SD-WAN devices: one over MPLS and another over Biz-Internet.\nTo test Packet Duplication, I’ll introduce artificial packet loss on the MPLS transport and run a basic iperf test between two clients to observe how the feature handles it.\nHere’s the test command I’ll use:\niperf3 -c 172.16.100.11 -u -b 1M -t 20 –dscp ef\nThis command initiates a 20-second UDP test targeting the remote client, using a bandwidth of 1 Mbps and marking the traffic with DSCP EF.\nNote I am not focusing on the exact percentage of packet loss introduced on MPLS. The idea isn’t to test how much packet duplication can recover, but rather to observe the mechanism in action. In theory, even with 100% loss on one transport, the traffic should still arrive via the other — as long as Packet Duplication is properly configured.\nThe sender uses biz-internet as the primary transport\nLisbon_10-1#show sdwan policy service-path vpn 10 interface gigabitEthernet 2 source-ip 172.16.10.11 dest-ip 172.16.100.11 protocol 17 dscp 46 all Number of possible next hops: 1 Next Hop: GRE Source: 31.11.0.2 Destination: 31.101.0.2 Local Color: biz-internet Remote Color: biz-internet Remote System IP: 1.1.100.1 Mpls has 80% loss and my iperf results were the following:\n[ ID] Interval Transfer Bitrate Jitter Lost/Total Datagrams [ 5] 0.00-20.00 sec 2.38 MBytes 1.00 Mbits/sec 0.000 ms 0/4188 (0%) sender [ 5] 0.00-20.04 sec 2.38 MBytes 998 Kbits/sec 0.255 ms 0/4188 (0.0%) receiver Let’s check the packet duplication statistics on both sender and receiver sides\nSender\nLisbon_10-1#show sdwan tunnel statistics pkt-dup Generating output, this might take time, please wait ... tunnel stats gre 21.11.0.2 21.101.0.2 0 0 pktdup-rx 14 pktdup-rx-other 0 pktdup-rx-this 14 pktdup-tx 0 pktdup-tx-other 4206 pktdup-capable true tunnel stats gre 31.11.0.2 31.101.0.2 0 0 pktdup-rx 0 pktdup-rx-other 14 pktdup-rx-this 0 pktdup-tx 4206 pktdup-tx-other 0 pktdup-capable true Center your attention on:\nRole Pkts sent primary tunnel Pkts dup secondary tunnel sender 4206 4206 The exact same amount of packets were transmitted over both mpls and biz-internet transports.\nReceiver\nMunich_DC100-1#show sdwan tunnel statistics pkt-dup Generating output, this might take time, please wait ... tunnel stats gre 21.101.0.2 21.11.0.2 0 0 pktdup-rx 0 pktdup-rx-other 758 pktdup-rx-this 0 pktdup-tx 14 pktdup-tx-other 0 pktdup-capable true tunnel stats gre 31.101.0.2 31.11.0.2 0 0 pktdup-rx 4206 pktdup-rx-other 0 pktdup-rx-this 758 pktdup-tx 0 pktdup-tx-other 14 pktdup-capable true Role Pkts Received primary Pkts received secondary Receiver 4206 758 Since the secondary transport was experiencing heavy packet loss, only 18% of packets were received through it. However, this was not an issue because the primary transport delivered 100% of the packets.\nIf the situation were reversed, with the primary path experiencing loss and the secondary path remaining healthy, the roles would simply swap. The primary would deliver 18% and secondary 100%, and once again, the end user wouldn’t experience any packet loss.\nConclusion Packet Duplication is a simple yet powerful feature in Cisco SD-WAN that significantly improves the reliability of traffic. By sending identical packets over multiple transport paths, it ensures that even if one path experiences loss, the application performance remains unaffected.\nWhile it does come at the cost of increased bandwidth usage and processing overhead, it can be a game-changer for critical traffic like voice, video, or remote desktop sessions, especially in environments with unreliable circuits.\nAs with any SD-WAN feature, the key is to use it strategically: enable it for the right traffic, monitor the results, and adjust policies based on your network’s behavior. Have you used Packet Duplication in production? Let me know your experience in the comments or connect with me on LinkedIn to discuss SD-WAN deep dives!\n",
  "wordCount" : "1209",
  "inLanguage": "en",
  "datePublished": "2025-06-03T00:00:00Z",
  "dateModified": "2025-06-03T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Alex"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/appqoe-pkt-dup-en/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "NetWithAlex",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/assets/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="NetWithAlex (Alt + H)">NetWithAlex</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="http://localhost:1313/es/" title="Español"
                            aria-label="Español">Es</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/category/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About me.">
                    <span>About me.</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="🔍">
                    <span>🔍</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      AppQoe Series: Packet Duplication
    </h1>
    <div class="post-description">
      Learn how Packet Duplication can help you reliably transmit critical traffic over unreliable transports to making sure your application.
    </div>
    <div class="post-meta"><span title='2025-06-03 00:00:00 +0000 +0000'>June 3, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Alex&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="http://localhost:1313/appqoe-pkt-dup-es/">Es</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#what-is-packet-duplication" aria-label="What is Packet Duplication">What is Packet Duplication</a></li>
                <li>
                    <a href="#considerations" aria-label="Considerations">Considerations</a></li>
                <li>
                    <a href="#configuration" aria-label="Configuration">Configuration</a></li>
                <li>
                    <a href="#verification" aria-label="Verification">Verification</a></li>
                <li>
                    <a href="#testing-packet-duplication" aria-label="Testing Packet Duplication">Testing Packet Duplication</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>On my <a href="/appqoe-fec-en/">previous post</a> I talked about FEC, a technique to fight packet loss by sending a parity packet to reconstruct missing data. In this post, we’ll explore another powerful SD-WAN feature designed to tackle lossy transports: <strong><em>Packet Duplication</em></strong>. While both features aim to improve reliability, they achieve it in very different ways.</p>
<p>Let&rsquo;s dive in:</p>
<h2 id="what-is-packet-duplication">What is Packet Duplication<a hidden class="anchor" aria-hidden="true" href="#what-is-packet-duplication">#</a></h2>
<p>As the name suggests, Packet Duplication involves sending identical packets over multiple transport paths to increase the likelihood of successful delivery. If one path experiences transient loss or is inherently unreliable, the duplicate packet sent over a second, more stable transport can make up for it, keeping the user experience unaffected.</p>
<p>To put it visually:</p>
<p><img loading="lazy" src="/wp-content/uploads/2025/05/pkt-dup1.png"></p>
<p>The sender uses <strong>both</strong> the bronze and gold transports to send the duplicate information. The bronze path suffers from packet loss, while the gold path delivers all packets successfully. The receiver discards duplicates and forwards only the earliest received copy to the destination, effectively eliminating loss from the user&rsquo;s perspective — regardless of which path the packet took.</p>
<p>Before duplicating a packet, the wan edge will compare its size against the Path Maximum Transmission Unit (PMUT), if the packet length is smaller than the PMUT, packet gets duplicated.</p>
<p><strong>Note</strong> Starting on version 17.15.1a, packets can be duplicated even if length is greater than PMUT, using <a href="https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/system-interface/ios-xe-17/systems-interfaces-book-xe-sdwan/configure-interfaces.html#g-fht-vfr-underlay-fragmentation" target="_blank" rel="nofollow noopener noreferrer">VRF and Underlay Fragmentation</a>.</p>
<p>Starting from version 16.12.1b this feature is applicable for</p>
<ul>
<li><em>IPv4 traffic over IPv4 tunnels</em>.</li>
</ul>
<p>Starting 17.15.1a to support is expanded to:</p>
<ul>
<li>IPv4 traffic over IPv6 tunnel</li>
<li>IPv6 traffic over IPv4 tunnels</li>
<li>IPv6 traffic over IPv6 tunnels</li>
</ul>
<h2 id="considerations">Considerations<a hidden class="anchor" aria-hidden="true" href="#considerations">#</a></h2>
<p>Here are a few key points to keep in mind when enabling Packet Duplication:</p>
<ul>
<li>For packet duplication to work, there should be <strong>at least</strong> two available transports, this is not a suitable solution for single transport sites.</li>
<li>The amount of traffic will be <strong>doubled</strong> keep it mind based on transport capacities.</li>
<li>The receiver will need to buffer and discard packets, adding processing <strong>overhead</strong></li>
<li>Should be enabled for <strong>critical traffic</strong> only, based on previous considerations.</li>
</ul>
<h2 id="configuration">Configuration<a hidden class="anchor" aria-hidden="true" href="#configuration">#</a></h2>
<p>Using Policy Groups, we can configure Packet Duplication through a data policy that matches intended traffic and applies an action of <em>Loss Correction</em> and select <em>Packet Duplication</em></p>
<p><img loading="lazy" src="/wp-content/uploads/2025/05/pkt-dup2.png"></p>
<p>This configuration should be applied on both directions, so the complete policy looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> data-policy data_service_Packet-Duplication
</span></span><span style="display:flex;"><span>  vpn-list vpn_Corporate_Users
</span></span><span style="display:flex;"><span>   sequence 1
</span></span><span style="display:flex;"><span>    match
</span></span><span style="display:flex;"><span>     source-ip      172.16.100.0/24
</span></span><span style="display:flex;"><span>     destination-ip 172.16.10.0/24
</span></span><span style="display:flex;"><span>    !
</span></span><span style="display:flex;"><span>    action accept
</span></span><span style="display:flex;"><span>     loss-protect pkt-dup
</span></span><span style="display:flex;"><span>     loss-protection packet-duplication
</span></span><span style="display:flex;"><span>    !
</span></span><span style="display:flex;"><span>   !
</span></span><span style="display:flex;"><span>   sequence 11
</span></span><span style="display:flex;"><span>    match
</span></span><span style="display:flex;"><span>     source-ip      172.16.10.0/24
</span></span><span style="display:flex;"><span>     destination-ip 172.16.100.0/24
</span></span><span style="display:flex;"><span>    !
</span></span><span style="display:flex;"><span>    action accept
</span></span><span style="display:flex;"><span>     loss-protect pkt-dup
</span></span><span style="display:flex;"><span>     loss-protection packet-duplication
</span></span><span style="display:flex;"><span>    !
</span></span><span style="display:flex;"><span>   !
</span></span><span style="display:flex;"><span>   default-action accept
</span></span><span style="display:flex;"><span>  !
</span></span><span style="display:flex;"><span> !
</span></span><span style="display:flex;"><span>!
</span></span><span style="display:flex;"><span>apply-policy
</span></span><span style="display:flex;"><span> site-list site_10_100
</span></span><span style="display:flex;"><span>  data-policy data_service_Packet-Duplication from-service
</span></span><span style="display:flex;"><span> !
</span></span><span style="display:flex;"><span>!
</span></span></code></pre></div><p><strong>Note</strong> Packet duplication is not supported along with the following data policy actions:</p>
<ul>
<li>local tloc</li>
<li>remote_tloc</li>
</ul>
<p>You can read the <a href="https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/policies/ios-xe-17/policies-book-xe/packet-duplication.html" target="_blank" rel="nofollow noopener noreferrer">configuration guide</a> to get more information on restrictions and more.</p>
<h2 id="verification">Verification<a hidden class="anchor" aria-hidden="true" href="#verification">#</a></h2>
<p>To ensure Packet Duplication is working there are a couple of things we can validate.</p>
<p>From the device we can run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Lisbon_10-1#show sdwan tunnel statistics pkt-dup 
</span></span><span style="display:flex;"><span>Generating output, this might take time, please wait ...
</span></span><span style="display:flex;"><span>tunnel stats gre 21.11.0.2 21.101.0.2 0 0
</span></span><span style="display:flex;"><span> pktdup-rx       4844
</span></span><span style="display:flex;"><span> pktdup-rx-other 1
</span></span><span style="display:flex;"><span> pktdup-rx-this  4844
</span></span><span style="display:flex;"><span> pktdup-tx       8710
</span></span><span style="display:flex;"><span> pktdup-tx-other 4693
</span></span><span style="display:flex;"><span> pktdup-capable  true
</span></span><span style="display:flex;"><span>tunnel stats gre 31.11.0.2 31.101.0.2 0 0
</span></span><span style="display:flex;"><span> pktdup-rx       1
</span></span><span style="display:flex;"><span> pktdup-rx-other 4844
</span></span><span style="display:flex;"><span> pktdup-rx-this  1
</span></span><span style="display:flex;"><span> pktdup-tx       4693
</span></span><span style="display:flex;"><span> pktdup-tx-other 8710
</span></span><span style="display:flex;"><span> pktdup-capable  true
</span></span></code></pre></div><ul>
<li>pktdup-rx - original packets received on primary tunnel</li>
<li>pktdup-rx-other - duplicate packets received on second tunnel</li>
<li>pktdup-tx - duplicate packets sent on primary tunnel</li>
<li>pktdup-tx-other - duplicate packets sent from secondary tunnel</li>
<li>pktdup-capable - Capability exchange with other devices</li>
</ul>
<p>The same information is available through the Manager&rsquo;s UI in the <em>Real Time</em> information section.</p>
<p><img loading="lazy" src="/wp-content/uploads/2025/05/pkt-dup3.png"></p>
<p>Additionally, a counter can be added the the policy to confirm the sequence is getting matched.</p>
<h2 id="testing-packet-duplication">Testing Packet Duplication<a hidden class="anchor" aria-hidden="true" href="#testing-packet-duplication">#</a></h2>
<p>In my setup, I have two active tunnels between the SD-WAN devices: one over MPLS and another over Biz-Internet.</p>
<p>To test Packet Duplication, I’ll introduce artificial packet loss on the MPLS transport and run a basic iperf test between two clients to observe how the feature handles it.</p>
<p>Here’s the test command I’ll use:</p>
<blockquote>
<p>iperf3 -c 172.16.100.11 -u -b 1M -t 20 &ndash;dscp ef</p>
</blockquote>
<p>This command initiates a 20-second UDP test targeting the remote client, using a bandwidth of 1 Mbps and marking the traffic with DSCP EF.</p>
<p><strong>Note</strong> I am not focusing on the exact percentage of packet loss introduced on MPLS. The idea isn’t to test how much packet duplication can recover, but rather to observe the mechanism in action. In theory, even with 100% loss on one transport, the traffic should still arrive via the other — as long as Packet Duplication is properly configured.</p>
<p>The sender uses biz-internet as the <strong>primary</strong> transport</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Lisbon_10-1#show sdwan policy service-path vpn 10 interface gigabitEthernet 2 source-ip 172.16.10.11 dest-ip 172.16.100.11 protocol 17 dscp 46 all            
</span></span><span style="display:flex;"><span>Number of possible next hops: 1
</span></span><span style="display:flex;"><span>Next Hop: GRE
</span></span><span style="display:flex;"><span>  Source: 31.11.0.2 Destination: 31.101.0.2 Local Color: biz-internet Remote Color: biz-internet Remote System IP: 1.1.100.1
</span></span></code></pre></div><p>Mpls has 80% loss and my iperf results were the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
</span></span><span style="display:flex;"><span>[  5]   0.00-20.00  sec  2.38 MBytes  1.00 Mbits/sec  0.000 ms  0/4188 (0%)  sender
</span></span><span style="display:flex;"><span>[  5]   0.00-20.04  sec  2.38 MBytes   998 Kbits/sec  0.255 ms  0/4188 (0.0%)  receiver
</span></span></code></pre></div><p>Let&rsquo;s check the packet duplication statistics on both sender and receiver sides</p>
<p>Sender</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Lisbon_10-1#show sdwan tunnel statistics pkt-dup
</span></span><span style="display:flex;"><span>Generating output, this might take time, please wait ...
</span></span><span style="display:flex;"><span>tunnel stats gre 21.11.0.2 21.101.0.2 0 0
</span></span><span style="display:flex;"><span> pktdup-rx       14
</span></span><span style="display:flex;"><span> pktdup-rx-other 0
</span></span><span style="display:flex;"><span> pktdup-rx-this  14
</span></span><span style="display:flex;"><span> pktdup-tx       0
</span></span><span style="display:flex;"><span> pktdup-tx-other 4206
</span></span><span style="display:flex;"><span> pktdup-capable  true
</span></span><span style="display:flex;"><span>tunnel stats gre 31.11.0.2 31.101.0.2 0 0
</span></span><span style="display:flex;"><span> pktdup-rx       0
</span></span><span style="display:flex;"><span> pktdup-rx-other 14
</span></span><span style="display:flex;"><span> pktdup-rx-this  0
</span></span><span style="display:flex;"><span> pktdup-tx       4206
</span></span><span style="display:flex;"><span> pktdup-tx-other 0
</span></span><span style="display:flex;"><span> pktdup-capable  true
</span></span></code></pre></div><p>Center your attention on:</p>
<table>
  <thead>
      <tr>
          <th>Role</th>
          <th>Pkts sent primary tunnel</th>
          <th>Pkts dup secondary tunnel</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>sender</td>
          <td>4206</td>
          <td>4206</td>
      </tr>
  </tbody>
</table>
<p>The exact same amount of packets were transmitted over both mpls and biz-internet transports.</p>
<p>Receiver</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Munich_DC100-1#show sdwan tunnel statistics pkt-dup
</span></span><span style="display:flex;"><span>Generating output, this might take time, please wait ...
</span></span><span style="display:flex;"><span>tunnel stats gre 21.101.0.2 21.11.0.2 0 0
</span></span><span style="display:flex;"><span> pktdup-rx       0
</span></span><span style="display:flex;"><span> pktdup-rx-other 758
</span></span><span style="display:flex;"><span> pktdup-rx-this  0
</span></span><span style="display:flex;"><span> pktdup-tx       14
</span></span><span style="display:flex;"><span> pktdup-tx-other 0
</span></span><span style="display:flex;"><span> pktdup-capable  true
</span></span><span style="display:flex;"><span>tunnel stats gre 31.101.0.2 31.11.0.2 0 0
</span></span><span style="display:flex;"><span> pktdup-rx       4206
</span></span><span style="display:flex;"><span> pktdup-rx-other 0
</span></span><span style="display:flex;"><span> pktdup-rx-this  758
</span></span><span style="display:flex;"><span> pktdup-tx       0
</span></span><span style="display:flex;"><span> pktdup-tx-other 14
</span></span><span style="display:flex;"><span> pktdup-capable  true
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th>Role</th>
          <th>Pkts Received primary</th>
          <th>Pkts received secondary</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Receiver</td>
          <td>4206</td>
          <td>758</td>
      </tr>
  </tbody>
</table>
<p>Since the secondary transport was experiencing heavy packet loss, only 18% of packets were received through it. However, this was not an issue because the primary transport delivered 100% of the packets.</p>
<p>If the situation were reversed, with the primary path experiencing loss and the secondary path remaining healthy, the roles would simply swap. The primary would deliver 18% and secondary 100%, and once again, the end user wouldn’t experience any packet loss.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Packet Duplication is a simple yet powerful feature in Cisco SD-WAN that significantly improves the reliability of traffic. By sending identical packets over multiple transport paths, it ensures that even if one path experiences loss, the application performance remains unaffected.</p>
<p>While it does come at the cost of increased bandwidth usage and processing overhead, it can be a game-changer for critical traffic like voice, video, or remote desktop sessions, especially in environments with unreliable circuits.</p>
<p>As with any SD-WAN feature, the key is to use it <strong>strategically</strong>: enable it for the right traffic, monitor the results, and adjust policies based on your network’s behavior. Have you used Packet Duplication in production? Let me know your experience in the comments or connect with me on <a href="https://www.linkedin.com/in/alexruizs/" target="_blank" rel="nofollow noopener noreferrer">LinkedIn</a> to discuss SD-WAN deep dives!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer><script src="https://utteranc.es/client.js"
        repo="aruiz-p/netwithalex"
        issue-term="title"
        label="comments"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">NetWithAlex</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
